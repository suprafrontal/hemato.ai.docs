
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="google-site-verification" content="S67CdslEMuwJk-vGSFetWi_eDgLAAML52KGMXn0ha8s" />
    <link href="images/favicon-a227ab59.svg" rel="icon" type="image/svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta
            name="description"
            content="Documentation for Hemato.AI Diagnostic API"
        >
    <title>API Reference</title>

    <style media="screen">
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cpf {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s, .highlight .sa, .highlight .dl {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf, .highlight .fm {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv, .highlight .vm {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .nl {
  color: #f92672;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <style media="print">
      * {
        -webkit-transition:none!important;
        transition:none!important;
      }
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight, .highlight .w {
  color: #586e75;
}
.highlight .err {
  color: #002b36;
  background-color: #dc322f;
}
.highlight .c, .highlight .ch, .highlight .cd, .highlight .cm, .highlight .cpf, .highlight .c1, .highlight .cs {
  color: #657b83;
}
.highlight .cp {
  color: #b58900;
}
.highlight .nt {
  color: #b58900;
}
.highlight .o, .highlight .ow {
  color: #93a1a1;
}
.highlight .p, .highlight .pi {
  color: #93a1a1;
}
.highlight .gi {
  color: #859900;
}
.highlight .gd {
  color: #dc322f;
}
.highlight .gh {
  color: #268bd2;
  background-color: #002b36;
  font-weight: bold;
}
.highlight .k, .highlight .kn, .highlight .kp, .highlight .kr, .highlight .kv {
  color: #6c71c4;
}
.highlight .kc {
  color: #cb4b16;
}
.highlight .kt {
  color: #cb4b16;
}
.highlight .kd {
  color: #cb4b16;
}
.highlight .s, .highlight .sb, .highlight .sc, .highlight .dl, .highlight .sd, .highlight .s2, .highlight .sh, .highlight .sx, .highlight .s1 {
  color: #859900;
}
.highlight .sa {
  color: #6c71c4;
}
.highlight .sr {
  color: #2aa198;
}
.highlight .si {
  color: #d33682;
}
.highlight .se {
  color: #d33682;
}
.highlight .nn {
  color: #b58900;
}
.highlight .nc {
  color: #b58900;
}
.highlight .no {
  color: #b58900;
}
.highlight .na {
  color: #268bd2;
}
.highlight .m, .highlight .mb, .highlight .mf, .highlight .mh, .highlight .mi, .highlight .il, .highlight .mo, .highlight .mx {
  color: #859900;
}
.highlight .ss {
  color: #859900;
}
    </style>
    <link href="stylesheets/screen-9c19b03a.css" rel="stylesheet" media="screen" />
    <link href="stylesheets/print-966d6edc.css" rel="stylesheet" media="print" />
      <script src="javascripts/all-ce55d38a.js"></script>

    <script>
      $(function() { setupCodeCopy(); });
    </script>
  </head>

  <body class="index" data-languages="[&quot;shell&quot;,&quot;go&quot;,&quot;typescript&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar-cad8cdcb.png" alt="" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="images/logo-c722fd2c.png" class="logo" alt="" />
        <div class="lang-selector">
              <a href="#" data-language-name="shell">shell</a>
              <a href="#" data-language-name="go">go</a>
              <a href="#" data-language-name="typescript">typescript</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <ul id="toc" class="toc-list-h1">
          <li>
            <a href="#introduction" class="toc-h1 toc-link" data-title="Introduction">Introduction</a>
          </li>
          <li>
            <a href="#endpoints" class="toc-h1 toc-link" data-title="Endpoints">Endpoints</a>
          </li>
          <li>
            <a href="#http-responses" class="toc-h1 toc-link" data-title="HTTP Responses">HTTP Responses</a>
          </li>
          <li>
            <a href="#authentication" class="toc-h1 toc-link" data-title="Authentication">Authentication</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#session-auth" class="toc-h2 toc-link" data-title="Session Auth">Session Auth</a>
                  </li>
                  <li>
                    <a href="#public-private-key-auth" class="toc-h2 toc-link" data-title="Public / Private Key Auth">Public / Private Key Auth</a>
                  </li>
                  <li>
                    <a href="#jwt-specifications" class="toc-h2 toc-link" data-title="JWT Specifications">JWT Specifications</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#get-a-pbs-report" class="toc-h1 toc-link" data-title="Get a PBS Report">Get a PBS Report</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#workflow-1" class="toc-h2 toc-link" data-title="Workflow 1">Workflow 1</a>
                  </li>
                  <li>
                    <a href="#workflow-2" class="toc-h2 toc-link" data-title="Workflow 2">Workflow 2</a>
                  </li>
              </ul>
          </li>
          <li>
            <a href="#health-check" class="toc-h1 toc-link" data-title="Health Check">Health Check</a>
          </li>
          <li>
            <a href="#errors" class="toc-h1 toc-link" data-title="Errors">Errors</a>
          </li>
      </ul>
        <ul class="toc-footer">
            <li><a href='https://hemato.ai'>Hemato.AI</a></li>
            <li><a href='mailto:ai@hemato.ai'>Sign Up for a Developer Key</a></li>
            <li><a href='https://github.com/slatedocs/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='introduction'>Introduction</h1>
<p>Welcome to the Hemato.AI Diagnostic API! You can use our API to access Hemato.AI&#39;s Diagnostic AI and Clinical Algorithms, which processes images of peripheral blood slides and generates hematopathology reports.</p>

<p>Examples on this page are in shell script and language bindings in Go, Typescript, Python, C#, and TypeScript coming in future! You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>
<h1 id='endpoints'>Endpoints</h1>
<p>Hemato.AI API is made available at specific regional endpoints to adhere to regional regulations. Any data submitted to a regional endpoint will be handled on servers located within the same geographical and regulatory region.</p>

<p>All Hemato.AI API endpoints are only available through encrypted (TLS) connections.</p>

<p>There are a few special purpose endpoints that are not region specific:
- For development and testing purposes anyone can use the Dev endpoint. To use this endpint you need to be assigned developer credentials. This endpoint is not HIPAA compliant and should not be used for any production purposes. Information submited to this service is not protected by any privacy laws and may be inspected by Hemato.AI staff.
- For external quality assurance and external automated testing you can use the QA endpoint. Specially it is imporant to run automated benchmarks agains this endpoint before any significant change to your hardware or sofrwre that has the potential to affect the quality, or clinical validity of the outputs. To use this endpoint you need QA credentials. This endpoint is not HIPAA compliant and should not be used for any production purposes. Information submited to this service is not protected by any privacy laws and may be inspected by Hemato.AI staff.</p>

<p>You can explicitly choose what region to use from this list:</p>

<table><thead>
<tr>
<th>Region</th>
<th>Endpoint</th>
<th>Users</th>
</tr>
</thead><tbody>
<tr>
<td>DEV</td>
<td>https://dev.api.hemato.ai</td>
<td>for development and testing purposes</td>
</tr>
<tr>
<td>QA</td>
<td>https://qa.api.hemato.ai</td>
<td>for external quality assurance and external automated testing</td>
</tr>
<tr>
<td>USA</td>
<td>https://us.api.hemato.ai</td>
<td>Production, for customers in the United States</td>
</tr>
<tr>
<td>Canada</td>
<td>https://ca.api.hemato.ai</td>
<td>Production, for customers in Canada</td>
</tr>
<tr>
<td>EU</td>
<td>https://eu.api.hemato.ai</td>
<td>Production, for customers in the European Union</td>
</tr>
</tbody></table>
<h1 id='http-responses'>HTTP Responses</h1>
<p>Most Hemato.AI API will return a JSON encoded response in this format.</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">202</span><span class="p">,</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"error message if any"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"user_message"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
  </span><span class="nl">"debug_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="err">//</span><span class="w"> </span><span class="err">helpful</span><span class="w"> </span><span class="err">information</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">debugging</span><span class="p">,</span><span class="w"> </span><span class="err">except</span><span class="w"> </span><span class="err">for</span><span class="w"> </span><span class="err">auth</span><span class="w"> </span><span class="err">debugging</span><span class="p">,</span><span class="w"> </span><span class="err">see</span><span class="w"> </span><span class="err">Auth</span><span class="w"> </span><span class="err">section</span><span class="w"> </span><span class="err">below</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<table><thead>
<tr>
<th>Field</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>status</td>
<td>This reflects the <a href="https://en.wikipedia.org/wiki/List_of_HTTP_status_codes">HTTP Status code</a> of the response.</td>
</tr>
<tr>
<td>error</td>
<td>If something has gone wrong, this provides an error message with error codes or more context on what has happened.</td>
</tr>
<tr>
<td>results</td>
<td>This is the output of the call, and can be of any type, often a dictionary / object.</td>
</tr>
<tr>
<td>user_message</td>
<td>This is a message that can be displayed to the end users. This is often useful in cases where there is an error.</td>
</tr>
<tr>
<td>debug_info</td>
<td>Contains helpful information for debugging</td>
</tr>
</tbody></table>
<h1 id='authentication'>Authentication</h1>
<p>All authenticated calls to Hemato.AI API are expected to present an <code>Authorization</code> header containing a signed and valid token.
To obtain an authorization token you have 2 options:</p>

<ol>
<li><strong>Session Based Authentication:</strong> you can call the <code>/auth/login</code> endpoint for a specific region and provide a user-name and password-hash (sha256 of the actual password) to obtain a newly minted and signed token. Session Auth is best suited for interactive applications where a user is directly involved in the process of obtaining the token. Example use cases are web applications, mobile apps, and desktop applications where individual users have Hemato.AI accounts. If you have a user facing application but your users don&#39;t hold individual Hemato.AI credentials, you can use the Public-Private Key authentication method below.</li>
<li><strong>Public-Private Key:</strong> you can create your own Public-Private key paris, and register your public keys with Hemato.AI. Then you can sign your own tokens using the private key associate with the public keys you registered with Hemato.AI. This is particularly helpful in situations where a user is not directly involved and a device or an automated system needs to make calls to Hemato.AI API. Examples a hardware device digitizes samples and needs to call Hemato.AI to obtain an interpretation of the sample. Or you have a mobile app and allows the users to interact with Hemato.AI but the users don&#39;t hold individual Hemato.AI accounts. To learn more read <a href="#Register-Public-Key">How to register your public keys with hemato</a></li>
</ol>
<h2 id='session-auth'>Session Auth</h2><div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># SECURITY RISK:</span>
<span class="c"># Please ONLY use this for debugging login problems.</span>
<span class="c"># MAKE SURE TO REMOVE THIS FROM YOUR SHELL HISTORY.</span>
<span class="c"># otherwise your plan password will remain in your shell history and possibly leak into backups and such.</span>

<span class="nb">echo</span> <span class="nt">-n</span> YOUR_ACTUAL_PASSWORD | shasum <span class="nt">-a</span> 256 | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1
</code></pre></div><div class="highlight"><pre class="highlight go tab-go"><code><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
    <span class="s">"crypto/sha256"</span>
    <span class="s">"fmt"</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="n">shasum</span> <span class="o">:=</span> <span class="n">sha256</span><span class="o">.</span><span class="n">Sum256</span><span class="p">([]</span><span class="kt">byte</span><span class="p">(</span><span class="s">"YOUR_ACTUAL_PASSWORD"</span><span class="p">))</span>
    <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s">"%x"</span><span class="p">,</span> <span class="n">shasum</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div><div class="highlight"><pre class="highlight typescript tab-typescript"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">CryptoJS</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">'</span><span class="s1">crypto</span><span class="dl">'</span>
<span class="kd">const</span> <span class="nx">passSha</span> <span class="o">=</span> <span class="nx">CtryptoJS</span><span class="p">.</span><span class="nx">SHA256</span><span class="p">(</span><span class="dl">'</span><span class="s1">YOUR_ACTUAL_PASSWORD</span><span class="dl">'</span><span class="p">).</span><span class="nx">toString</span><span class="p">(</span><span class="nx">CryptoJS</span><span class="p">.</span><span class="nx">enc</span><span class="p">.</span><span class="nx">Hex</span><span class="p">)</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">passSha</span><span class="p">)</span>
</code></pre></div>
<p>For interactive use cases, where you or your users hold individual Hemato.AI accounts, you can use the Session Auth method. This method is best suited for web applications, mobile apps, and desktop applications where individual users have Hemato.AI accounts.</p>

<p>This call does NOT accept the raw user password. Instead you need to provide the sha256 hash of the password. This is to prevent the password from being leaked in internet trafic capture or intercepted on device or in transit. Of course all Hemato.AI endpoints are only available only through encrypted (TLS) connections. Still there are scenarios that a client browser or tools might allow for interception of traffic. You can use the following command to generate the sha256 hash of your password:</p>

<blockquote>
<p>To authorize, using Session Authentication:</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># SECURITY RISK:</span>
<span class="c"># Please ONLY use this for debugging login problems.</span>
<span class="c"># MAKE SURE TO REMOVE THIS FROM YOUR SHELL HISTORY.</span>
<span class="c"># otherwise your plan password will remain in your shell history and possibly leak into backups and such.</span>
<span class="nb">export </span><span class="nv">PASS_SHA_256</span><span class="o">=</span><span class="sb">`</span><span class="nb">echo</span> <span class="nt">-n</span> YOUR_ACTUAL_PASSWORD | shasum <span class="nt">-a</span> 256 | <span class="nb">cut</span> <span class="nt">-d</span> <span class="s1">' '</span> <span class="nt">-f</span> 1<span class="sb">`</span>
<span class="c"># use httpie from https://httpie.io/</span>
<span class="nb">echo</span> <span class="s1">'{"user":"ali@example.com","pass_hash":"'</span><span class="k">${</span><span class="nv">PASS_SHA_256</span><span class="k">}</span><span class="s1">'"}'</span> | http <span class="nt">-F</span> POST https://api.hemato.ai/auth/login
<span class="c"># or use curl, you can just pass the correct header with each request</span>
<span class="nb">echo</span> <span class="s1">'{"user":"ali@example.com","pass_hash":"'</span><span class="k">${</span><span class="nv">PASS_SHA_256</span><span class="k">}</span><span class="s1">'"}'</span> | curl <span class="nt">-X</span> POST <span class="s2">"https://api.hemato.ai/auth/login"</span>
</code></pre></div><div class="highlight"><pre class="highlight go tab-go"><code><span class="c">// Not implemented yet</span>
</code></pre></div>
<blockquote>
<p>The above command returns a JSON structure like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">202</span><span class="p">,</span><span class="w">
    </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"login_timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1682945428455621477"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"token"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"HY_APP_AUTH_v1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9E....."</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ali@example.com"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"03349841-588d-56b3-b93c-52d0983f9c75"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"screen_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Ali"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"user_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"ali@example.com"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"debug_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"delta"</span><span class="p">:</span><span class="w"> </span><span class="s2">"463.021938ms"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bb_api.362.pbs_tasks.dfd119b"</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h2 id='public-private-key-auth'>Public / Private Key Auth</h2>
<p>You can sign your own Authentications headers, see <a href="#JWT-Specifications">JWT specifications</a>.</p>

<p>A self-service dashboard to register your public keys is coming soon. In the meantime, please contact us to register your public keys.</p>
<h2 id='jwt-specifications'>JWT Specifications</h2>
<p>If you are using Public-Private Key Auth, you will be generating and signing your own Authorizaiton headers.
Hemato.AI authorization headers are JSON Web Tokens (JWT) (more info at (https://jwt.io/)[https://jwt.io/]).</p>
<h3 id='suppoted-signing-algorithms'>Suppoted Signing Algorithms</h3>
<p>Curently only <code>RS256</code> (RSASSA-PKCS-v1.5 using SHA-256) is allowed.</p>
<h3 id='required-fields'>Required Fields</h3>
<p>All the fields in this table are required.
All keys and values are case sensitive.
All JWTs need to be BASE64 encoded when used as Authorization headers.</p>

<table><thead>
<tr>
<th>JWT Claim</th>
<th>Abbreviated</th>
<th>Data Type</th>
<th>Notes</th>
</tr>
</thead><tbody>
<tr>
<td>Token ID</td>
<td><code>jti</code></td>
<td>String</td>
<td>A unique ID for each token. Most useful for audit, debugging and investigation of issues. UUID or high resolution timestamps can be used.</td>
</tr>
<tr>
<td>Issuer</td>
<td><code>iss</code></td>
<td>String</td>
<td>This is the identifier of your organization.</td>
</tr>
<tr>
<td>Issed at</td>
<td><code>iat</code></td>
<td>Unix Time aka IntDate</td>
<td>The time the token was issues. A token issued in future is invalid. A token more than 1 hour is considered expired.</td>
</tr>
<tr>
<td>Expiraion</td>
<td><code>exp</code></td>
<td>Unix Time aka IntDate</td>
<td>The time this token will expire and be invalid.  A token more than 1 hour is considered expired, regardless of this value.</td>
</tr>
<tr>
<td>Audience</td>
<td><code>aud</code></td>
<td>String</td>
<td>This needs to match the domain and region you are calling. Examples are: <code>us.api.hemato.ai</code> or <code>dev.api.hemato.ai</code></td>
</tr>
<tr>
<td>----------</td>
<td>-------------</td>
<td>-----------------------</td>
<td>----------------------------------</td>
</tr>
<tr>
<td>User ID</td>
<td><code>uid</code></td>
<td>String</td>
<td>This needs to be one of the user ids from the same organization where the signing key belongs to and this use must have permission to access to region.</td>
</tr>
<tr>
<td>----------</td>
<td>-------------</td>
<td>-----------------------</td>
<td>----------------------------------</td>
</tr>
<tr>
<td>Key ID *</td>
<td><code>kid</code></td>
<td>String</td>
<td>Only required if using <code>RS256</code> signing algorithm. This is the ID of the public key that was used to sign the token.</td>
</tr>
<tr>
<td>----------</td>
<td>-------------</td>
<td>-----------------------</td>
<td>----------------------------------</td>
</tr>
</tbody></table>
<h3 id='how-to-create-your-own-keys'>How to create your own keys</h3><div class="highlight"><pre class="highlight shell tab-shell"><code>ssh-keygen <span class="nt">-t</span> rsa <span class="nt">-b</span> 4096 <span class="nt">-m</span> PEM <span class="nt">-f</span> jwtRS256.key
<span class="c"># Don't add passphrase</span>
openssl rsa <span class="nt">-in</span> jwtRS256.key <span class="nt">-pubout</span> <span class="nt">-outform</span> PEM <span class="nt">-out</span> jwtRS256.key.pub
<span class="nb">cat </span>jwtRS256.key
<span class="nb">cat </span>jwtRS256.key.pub
</code></pre></div><h3 id='example'>Example</h3>
<p>On the right you can see an example of a Hemato.AI JWT</p>

<blockquote>
<p>This is the structure of a Hemato.AI JWT
<code>json
{
  &quot;alg&quot;:&quot;HS256&quot;, // or RS256
  &quot;typ&quot;:&quot;JWT&quot;
}
.
{
  &quot;aud&quot;: [
    &quot;us.api.hemato.ai&quot;,
  ],
  &quot;exp&quot;: 1683095428,
  &quot;iat&quot;: 1682945428,
  &quot;iss&quot;: &quot;1stdevision.example.com&quot;,
  &quot;jti&quot;: &quot;2d33d1d518&quot;,
  &quot;sub&quot;: &quot;1st_devision_api_user&quot;,
  &quot;uid&quot;: &quot;01234567-789d-46b7-b38c-45d4562f5c12&quot;,
  &quot;kid&quot;: &quot;01234567-789d-46b7-b38c-45d4562f5c12&quot;
}
</code></p>
</blockquote>
<h3 id='debugging-jwts'>Debugging JWTs</h3>
<p>You can decode and inspect your JWTs at <a href="https://jwt.io/">https://jwt.io/</a></p>

<p>You can also make a call to <code>/auth/hello</code> endpoint and get more helpful information about your JWT and reasons it may be rejected.</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># if you are using httpie</span>
http <span class="nt">-f</span> POST https://dev.api.hemato.ai/auth/helo Authorization:HEMATO_AI_AUTH_TOKEN
<span class="c"># if you are using curl</span>
curl <span class="nt">-x</span> POST <span class="nt">--header</span> <span class="s2">"Authorization:HEMATO_AI_AUTH_TOKEN"</span> https://api.hemato.ai/auth/hello
</code></pre></div><h1 id='get-a-pbs-report'>Get a PBS Report</h1>
<p>Images of Peripheral Blood Smears (PBS) usually are very large. It is often impractical to submit an entire sample in one API call.
That&#39;s why there are a few steps to submit a PBS for review by Hemato.AI.</p>

<p>There are two workflows available to get Hemato.AI to study a peripheral blood sample and generate morphological, diagnostic and pathology reports.</p>

<p>In <strong>Workflow 1</strong>, you make API calls to upload the images, request a diagnostic study and get the results.</p>

<p>In <strong>Workflow 2</strong>, you make an API call to provide a link where Hemato.AI can download your files and then you can make an API call to get the results.</p>
<h2 id='workflow-1'>Workflow 1</h2>
<p>In workflow 1, to get Hemato.AI&#39;s opinion on a Peripheral Blood Smear you follow these steps:</p>

<ol>
<li>Get an ID for your new PBS</li>
<li>Upload the files under the new ID</li>
<li>Request a Diagnostic Study</li>
<li>Wait for it</li>
<li>Ask for the report</li>
</ol>

<p><img src="images/PBSStudyWorkflow1-5a45cc0d.png" alt="Peripheral Blood Study Flow 1" /></p>
<h3 id='1-get-an-id'>1. Get an ID</h3>
<p>Get a new PBS ID. This ID will be used to upload the images, request diagnostic study of the sample, provide any other information available and afterwards get the results of Hemato.AI&#39;s review.</p>
<h4 id='http-request'>HTTP Request</h4>
<p>Make a <code>POST</code> call to the <code>/pbs</code> endpoint. You can provide any number of tags (key value string pairs) along side this request. These tags can allow you to associate Patient Proxy Identifiers or Organization IDs or any number of other information that is important to you with the PBS. These tags can later be used to find and retrieve PBSs easier.
<aside class="warning">Please do NOT include any Personanlly Identifiable Information (PII) or Personal Health Records (PHI) in the tags</aside></p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># use httpie from https://httpie.io/</span>
<span class="nb">echo</span> <span class="s1">'{"tags":{"patient_proxy_id":"}}'</span> | http <span class="nt">-f</span> POST https://api.hemato.ai/pbs Authorization:HEMATO_AI_AUTH_TOKEN
<span class="c"># alternatively use curl</span>
curl <span class="nt">-x</span> POST <span class="nt">--header</span> <span class="s2">"Authorization:HEMATO_AI_AUTH_TOKEN"</span> https://api.hemato.ai/pbs
</code></pre></div>
<blockquote>
<p>Make sure to replace <code>HEMATO_AI_AUTH_TOKEN</code> with your API key.</p>

<p>The above command returns a JSON structure like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">201</span><span class="p">,</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:{</span><span class="w">
    </span><span class="nl">"pbs_study_id"</span><span class="p">:</span><span class="s2">"c7d453a9-676d-4b9f-a505-8a9021b76dfd"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='2-upload-the-files'>2. Upload the files</h3>
<p>Upload the sample by calling the PBS upload API as many times as needed.</p>
<h4 id='http-request-2'>HTTP Request</h4>
<p>Make a <code>POST</code> call to the <code>/pbs/YOUR_NEW_PBS_ID/files?file_name=some_file_name.jpg</code> endpoint. Here <code>YOUR_NEW_PBS_ID</code> is the id you obtained from step 1 (<code>results.pbs_id</code> in the response structure returned).</p>

<p>This api accepts an optional &quot;file_name&quot; and stors this along side the file. This can be later used for audit purposes.</p>

<p>This is an idempotent call. It means you can send the same file multiple times and it will only be counted as one file.
Once submitted however, you cannot update the same file or change it or its metadata. You can only add more  files to the same PBS study.</p>

<p>The file type is determined by the <code>Content-Type</code> header of your request. So when sending a request to upload a jpg file for example, your request needs to have a header <code>Content-Type:image/jpeg</code>.
This endpoint accepts:</p>

<table><thead>
<tr>
<th>File Type</th>
<th>Request Content-Type Header</th>
</tr>
</thead><tbody>
<tr>
<td>jpeg , jpg</td>
<td>image/jpeg</td>
</tr>
<tr>
<td>png</td>
<td>image/png</td>
</tr>
<tr>
<td>zip ★</td>
<td>application/zip</td>
</tr>
</tbody></table>

<p>★ Zip files can contain jpg or png files.</p>

<p>If the Content-Type header is missing, the file name extension for &quot;file_name&quot; provided is used to determine the file type.
If no file type can be determined or provided, a 400 - Bad Request error is returned.</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># use httpie from https://httpie.io/</span>
http <span class="nt">-f</span> POST https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/files Authorization:HEMATO_AI_AUTH_TOKEN Content-Type:image/jpeg  &lt; /path/to/filename.jpg
<span class="c"># alternatively use curl</span>
curl <span class="nt">-x</span> POST <span class="nt">--header</span> <span class="s2">"Authorization:HEMATO_AI_AUTH_TOKEN"</span> <span class="nt">--header</span> <span class="s2">"Content-Type:image/jpeg"</span> <span class="nt">--data-binary</span> <span class="s2">"@/path/to/filename.jpg"</span>  https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/files
</code></pre></div>
<blockquote>
<p>The above command returns a JSON structure like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">201</span><span class="p">,</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:{</span><span class="w">
    </span><span class="nl">"pbs_study_id"</span><span class="p">:</span><span class="s2">"c7d453a9-676d-4b9f-a505-8a9021b76dfd"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"file_id"</span><span class="p">:</span><span class="s2">"sha224-i-4d58b0cee1e38f75f93e2e605d1e6ad44c24a975d0c3b53367de7c86"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"debug_info"</span><span class="p">:{</span><span class="w">

  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<aside class="warning">Notes:<ul>
<li>Please note that this is NOT an HTTP multipart call with `Content-Type: multipart/form-data` </li>
<li>Plaese note that this is not a form submission call either. The entire body of the request is the image.
</ul>
</aside>
<h3 id='3-request-a-diagnostic-study'>3. Request a Diagnostic Study</h3>
<p>When all the files for a particular PBS is uploaded, you will make a call to mark the PBS as ready to be processed and ask for any number of diagnostics tasks to be performed on this PBS. After this call you will not be able to upload additional files for this PBS.</p>

<p>Optionally you can register a <code>callback_url</code> that will be called when the report is ready.
We’ll send a POST request to the callback URL with details of the report when ready.
The callback url needs to accept a POST call, and must support HTTPS with a valid server certificate. The body of the call will conform to <code>{&quot;pbs_stody_id&quot;:&quot;25f7de38-ba9c-4b45-a4d8-8c13461d7b39&quot;, &quot;report_status&quot;: &quot;ready&quot;, &quot;progress&quot;: 1.0}</code> but it can be ignored.
So there are two approaches that users can take:
1. Include the <code>pbs_study_id</code> or any other information you need (no PII or PHI) in the url to be called.
2. Use a single generic url, but parse and use the information in the body to identify which study is the subject of the call back.</p>

<p>Although it is not strictly needed, we recommend you include a cryptographic signature as part of your URL, to that you can verify the authenticity of the cells to your endpoint. Example:
<code>{&quot;callback_url&quot;:&quot;https://example.com/pbs_report_is_ready/&lt;PBS_STUDY_ID&gt;/&lt;timestamped_cryptographic_signature_valid_only_for_this_PBS_STUDY_ID&gt;&quot;</code></p>

<p>This enables early filtration of incoming traffic, particularly in cases where the backend systems may be inundated by a surge of malicious or rogue requests.</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c"># use httpie from https://httpie.io/</span>
<span class="nb">echo</span> <span class="s1">'{"diagnostic_tasks":["pbs_v1"], "callback_url":"https://example.com/pbs_report_is_ready/&lt;PBS_STUDY_ID&gt;/"}'</span> | http <span class="nt">-f</span> POST https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/tasks Authorization:HEMATO_AI_AUTH_TOKEN
<span class="c"># alternatively use curl</span>
<span class="nb">echo</span> <span class="s1">'{"diagnostic_tasks":["pbs_v1"], "callback_url":"https://example.com/pbs_report_is_ready/&lt;PBS_STUDY_ID&gt;/"}'</span> | curl <span class="nt">-x</span> POST <span class="nt">--header</span> <span class="s2">"Authorization:HEMATO_AI_AUTH_TOKEN"</span> <span class="nt">--data-binary</span> @- https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/tasks
</code></pre></div>
<blockquote>
<p>The above command returns a JSON structure like this:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:{</span><span class="w">
    </span><span class="nl">"pbs_study_id"</span><span class="p">:</span><span class="s2">"48ae6352-d15d-440a-83f3-05a1f68aa11b"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
      </span><span class="s2">"pbs_v1"</span><span class="w">
    </span><span class="p">]</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='4-wait-for-it'>4. Wait for it</h3>
<p>Depending on the size of the files submitted, the number Diagnostic tasks requested, and other factors like general system workload, it will take between a few seconds to 10s of seconds for the results to be ready.</p>

<p>If you registerd a callback url in step 3, you can wait for that url to be called.</p>

<p>You can check the status of the task by making a GET call to /status</p>

<blockquote>
<p>To get the status of a PBS</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c">#</span>
http https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/status Authorization:HEMATO_AI_AUTH_TOKEN
<span class="c">#</span>
curl <span class="nt">--header</span> <span class="s2">"Authorization:HEMATO_AI_AUTH_TOKEN"</span> https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/status
</code></pre></div>
<blockquote>
<p>This returns
<code>json
{
  &quot;status&quot;: 200,
  &quot;results&quot;: {
    &quot;pbs_study_id&quot;: &quot;62dd0300-880e-4069-bea8-66c9ca73c207&quot;,
    &quot;report_status&quot;: &quot;ready&quot;,
    &quot;progress&quot;: 1.0,
    &quot;progress_message&quot;:&quot;Reports are ready&quot;,
  },
  &quot;debug_info&quot; :{}
}
</code></p>
</blockquote>
<h3 id='5-get-the-report-for-a-peripheral-blood-smear-study'>5. Get The Report for a Peripheral Blood Smear Study</h3>
<p>You can get the latest version of the report by making a GET call.
In cases that there are multiple revisions and you want to get an earlier version of the report you need to specify the version.</p>

<blockquote>
<p>To get the latest diagnostic report on a PBS</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="c">#</span>
http https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/report Authorization:HEMATO_AI_AUTH_TOKEN
<span class="c">#</span>
curl <span class="nt">--header</span> <span class="s2">"Authorization:HEMATO_AI_AUTH_TOKEN"</span> https://api.hemato.ai/pbs/YOUR_NEW_PBS_ID/report
</code></pre></div>
<blockquote>
<p>Which in turn returns a JSON structure like:</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="p">,</span><span class="w">
    </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"pbs_study_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4bb7fe9e-b608-4d68-adbe-8655c991f494"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"file_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"sha224-i-db367ccd89fc39aa6ff9fff0cd9b11e6b5b6a41cff4bbb232bee7c93"</span><span class="p">],</span><span class="w">
        </span><span class="nl">"feature_statistics"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"rbc-density"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"y"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"platelet-density"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"y"</span><span class="w">
            </span><span class="p">},</span><span class="w">
            </span><span class="nl">"blast-density"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"value"</span><span class="p">:</span><span class="w"> </span><span class="s2">"x"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"unit"</span><span class="p">:</span><span class="w"> </span><span class="s2">"y"</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"morphological_findings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"ring trophozoite"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
                </span><span class="nl">"count"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"heat_map"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                    </span><span class="nl">"center"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">435</span><span class="p">,</span><span class="w"> </span><span class="mi">345</span><span class="p">],</span><span class="w">
                    </span><span class="nl">"radius"</span><span class="p">:</span><span class="w"> </span><span class="mi">35</span><span class="w">
                </span><span class="p">}]</span><span class="w">
            </span><span class="p">}</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"diagnostic_report"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
            </span><span class="nl">"differential_diagnosis"</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w">
                </span><span class="nl">"score"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="p">,</span><span class="w">
                </span><span class="nl">"confidence"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.95"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"clinical-significance"</span><span class="p">:</span><span class="w"> </span><span class="s2">"D"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"icd10-code"</span><span class="p">:</span><span class="w"> </span><span class="s2">"B50"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"english-long"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Malaria Infection with Plasmodium Falciparum"</span><span class="p">,</span><span class="w">
                </span><span class="nl">"english-short"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Malaria"</span><span class="w">
            </span><span class="p">}]</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="nl">"pathology_report"</span><span class="p">:</span><span class="w"> </span><span class="s2">"No demographics or past medical history is available about the patient. Inspection of peripheral blood slide revealed ring trophozoites ..."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"debug_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>There are 3 levels of report available.</p>

<ol>
<li>Morphological Findings</li>
<li>Diagnostic Information</li>
<li>Pathology Report</li>
</ol>
<h2 id='workflow-2'>Workflow 2</h2>
<p>In workflow 2, to get Hemato.AI&#39;s opinion on a Peripheral Blood Smear you follow these steps:</p>

<ol>
<li>Submit a url from which Hemato.AI can download the files and get an Study ID back (you can use this ID to check the status of the study and get the report)</li>
<li>Optionally provide a callback url</li>
<li>Wait for it</li>
<li>Get a callback, with information about the sample, dwnloaded file size and formats and sanity checks.</li>
<li>Wait for it</li>
<li>Get a callback, with information about the report, and a link to the report</li>
<li>Check the status of the study and get the report</li>
</ol>

<p><img src="images/PeripheralBloodWorkflows-1377eec7.png" alt="Peripheral Blood Study Flow 2" /></p>
<h3 id='1-2-3-submit-a-url-from-which-hemato-ai-can-download-the-files-and-get-an-study-id-back'>1,2,3. Submit a url from which Hemato.AI can download the files and get an Study ID back</h3>
<p>You can make a POST call to <code>/pbs</code> with a url to retrieve a list of files from. this call will return a Study ID that you can use to check the status of the study and get the report.
The call needs to include a list of diagnstic tasks that you want to be performed on the files.
The list of files returned by the provided list_url can be a list of presigned urls to files in an S3 bucket, or a list of urls to files in a publically accessible location, or in some other way need to be accessible to Hemato.AI.</p>

<p>The body of this POST request will look like the example on the right:</p>

<blockquote>
<p>Request body to start &quot;Workflow 2&quot;</p>
</blockquote>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"list_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/samples/1/files.json"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"tasks"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"pbs_v1"</span><span class="w">
  </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<p>On the right you can see an example of the list of files that will be downloaded by Hemato.AI as a single periheral blood study.</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"peripheral_blood_sample_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"62dd0300-880e-4069-bea8-66c9ca73c207"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"patient_proxy_medical_record_number"</span><span class="p">:</span><span class="w"> </span><span class="s2">"123456789"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"sample_collection_timestamp"</span><span class="p">:</span><span class="w"> </span><span class="s2">"2021-01-02T15:0405+07:00"</span><span class="p">,</span><span class="w"> </span><span class="err">//</span><span class="w"> </span><span class="err">RFC</span><span class="mi">3339</span><span class="w"> </span><span class="err">formated</span><span class="w"> </span><span class="err">date</span><span class="w"> </span><span class="err">time</span><span class="w">
  </span><span class="nl">"clinical_tasks_requested"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"pbs_v1"</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"files"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="s2">"https://presignedurldemo.s3.eu-west-2.amazonaws.com/image.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&amp;X-Amz-Credential=AKIAJJWZ7B6WCRGMKFGQ%2F20180210%2Feu-west-2%2Fs3%2Faws4_request&amp;X-Amz-Date=20180210T171315Z&amp;X-Amz-Expires=1800&amp;X-Amz-Signature=12b74b0788aa036bc7c3d03b3f20c61f1f91cc9ad8873e3314255dc479a25351&amp;X-Amz-SignedHeaders=host"</span><span class="p">,</span><span class="w">
    </span><span class="err">...</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="nl">"callback_url"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://example.com/callbacks/1"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div>
<blockquote>
<p>To submit a url to a Peripheral Blood Smear Study</p>
</blockquote>
<div class="highlight"><pre class="highlight shell tab-shell"><code><span class="nb">echo</span> <span class="s1">'{"peripheral_blood_sample_id":"xyz", "patient_proxy_medical_record_number":"abc", ... }'</span> | http <span class="nt">-F</span> POST https://dev.api.hemato.ai/pbs Authorization:HEMATO_AI_AUTH_TOKEN
</code></pre></div><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"results"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"pbs_study_id"</span><span class="p">:</span><span class="w"> </span><span class="s2">"4bb7fe9e-b608-4d68-adbe-8655c991f494"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"file_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"sha224-i-db367ccd89fc39aa6ff9fff0cd9b11e6b5b6a41cff4bbb232bee7c93"</span><span class="p">]</span><span class="w">
  </span><span class="p">},</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='4-5-receive-a-callback-with-information-about-the-sample-downloaded-file-size-and-formats-and-sanity-checks'>4,5 Receive a callback with information about the sample, downloaded file size and formats and sanity checks.</h3>
<p>When the study has been downloaded and the files have been checked for sanity, you will receive a callback to the callback_url you provided in the previous step.</p>

<p>The example on the right shows the body of a callback request.</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='6-receive-a-callback-with-information-about-the-report-and-a-link-to-the-report'>6 Receive a callback with information about the report, and a link to the report</h3>
<p>When the study has been analysed and the report is ready, you will receive a callback to the callback_url you provided in the previous step.</p>

<p>The example on the right shows the body of a callback request.</p>
<div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">

</span><span class="p">}</span><span class="w">
</span></code></pre></div><h3 id='7-check-the-status-of-the-study-and-get-the-report'>7 Check the status of the study and get the report</h3>
<p>You can make a GET call to <code>/pbs/{pbs_study_id}/status</code> to get the status of the study and the report.</p>

<p>To retrive the reports you can make a call to <code>/pbs/{pbs_study_id}/report</code>.
for more information see the same call in &quot;workflow 1&quot; above (step: get the report for peripheral blood study).</p>
<h1 id='health-check'>Health Check</h1>
<p>If you need to check the health status of the Hemato.AI api you can make a GET call to the heartbeat endpoint.</p>
<div class="highlight"><pre class="highlight shell tab-shell"><code>http https://api.hemato.ai/heartbeat
</code></pre></div><div class="highlight"><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
    </span><span class="nl">"delta"</span><span class="p">:</span><span class="w"> </span><span class="s2">"59.078µs"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"heartbeat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a7ef8fba741237f693c3"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"request_timestamp"</span><span class="p">:</span><span class="w"> </span><span class="mi">1680716829</span><span class="p">,</span><span class="w">
    </span><span class="nl">"version"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bb_api.331.develop.18ff645"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div><h1 id='errors'>Errors</h1>
<p>The Hemato.AI API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request -- Your request is invalid.</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized -- Your API key is not correctly signed or expired.</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden -- Your token does not grant you permission to perform this task.</td>
</tr>
<tr>
<td>404</td>
<td>Not Found -- The specified resource could not be found.</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed -- You tried to access a resource with an invalid method.</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable -- You requested a format that isn&#39;t json.</td>
</tr>
<tr>
<td>418</td>
<td>I&#39;m a teapot. (for debugging purposes)</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests -- You&#39;re being throttled</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error -- Our apologies, We had a problem with our server. Please try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable -- Our apologies, We&#39;re temporarily offline. Please try again later.</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
                <a href="#" data-language-name="go">go</a>
                <a href="#" data-language-name="typescript">typescript</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
</div>
<!-- footer ------------------ -->
<footer class="bg-white">
  <div className="mt-1 grid w-full justify-items-stretch bg-white">
  <div className="mx-2 inline-flex h-auto justify-self-center rounded bg-transparent px-1 text-xs text-pink-300">
    <span id="versionSpan" className="text-pink-300">Version:&nbsp;</span>
  </div>
</footer>
<script>
  var tocFooter = document.getElementsByClassName("toc-footer")[0];
  var li = document.createElement("li");
  li.appendChild(document.createTextNode('V: ' + hematoDocsVersion()));
  li.setAttribute("id", "version"); // added line
  tocFooter.appendChild(li);
</script>
  </body>
  <!-- Cloudflare Web Analytics --><script defer src='https://static.cloudflareinsights.com/beacon.min.js' data-cf-beacon='{"token": "24ac413283304895aab4128d7b67e266"}'></script><!-- End Cloudflare Web Analytics -->
</html>
